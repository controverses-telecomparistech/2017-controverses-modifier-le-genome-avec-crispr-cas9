<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>WebGL model renderer</title>
    <script src="three.min.js"></script>
    <script src="TrackballControls.js"></script>
    <style>
      body { margin:0.; }
      canvas { width:100%; height:100%; }
    </style>
  </head>
  <body>
    <script type="text/javascript">
      // Renderer code
      var renderer, scene, camera, mesh, controls;
      
      initScene();
      animate();
      
      function initScene()
      {
        renderer = new THREE.WebGLRenderer({ antialias:true });
        renderer.setSize(window.innerWidth, window.innerHeight);
        document.body.appendChild(renderer.domElement);
        
        scene = new THREE.Scene();
        camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 1, 1000);
        camera.position.z = 10;
        scene.add(camera);
        
        var dirLight = new THREE.DirectionalLight(0xffffff, 0.95);
        dirLight.position.set(-3, 3, 7);
        dirLight.position.normalize();
        scene.add(dirLight);
        
        var pointLight = new THREE.PointLight(0xffffff, 5, 50);
        pointLight.position.set(10, 20, -10);
        scene.add(pointLight);
        
        var jsonLoader = new THREE.ObjectLoader();
        jsonLoader.load("teapot-claraio.json", function(geometry)
          {
            mesh = geometry;
            mesh.rotation.z = 0.5;
            setupControls();
            scene.add(mesh);
          });
      }
      
      function setupControls()
      {
        controls = new THREE.TrackballControls(camera, renderer.domElement);
        controls.rotateSpeed = 3.0;
        controls.zoomSpeed = 1.2;
        controls.panSpeed = 1.0;
        controls.noZoom = false;
        controls.noPan = false;
        controls.staticMoving = false;
        controls.dynamicDampingFactor = 0.3;
        controls.minDistance = 1.1;
        controls.maxDistance = 100;
        controls.keys = [16, 17, 18];
      }
      
      function animate()
      {
        requestAnimationFrame(animate);
        if(mesh)
        {
          mesh.rotation.y += 0.02;
        }
        render();
      }
      
      function render()
      {
        camera.lookAt(scene.position);
        if(controls)
          controls.update();
        renderer.render(scene, camera);
      }
    </script>
  </body>
</html>
